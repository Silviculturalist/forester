#' Basal area growth functions for even-aged monocultures or mixed stands in Sweden.
#'
#' @source Ekö, Per Magnus (1985) "En produktionsmodell för skog i Sverige, baserad på bestånd från
#' riksskogstaxeringens provytor: A growth simulator for Swedish forests, based on
#' data from the national forest survey. Rapporter nr. 16. Swedish University of
#' Agricultural Sciences, dept. of Silviculture. Umeå. ISBN 91-576-2386-4. ISSN
#'  0348-8969.  p. 63.
#'
#' @description
#'
#' \strong{Pine, northern Sweden}
#' Number of observations: 3461
#'
#' \tabular{lrrr}{
#' Thinning \tab SI<160 \tab 160≤SI<200 \tab SI≥200 \cr
#' Unthinned \tab 920 \tab 1014 \tab 523 \cr
#' Thinned \tab 319 \tab 441 \tab 244 \cr
#' }
#'
#' Multiple correlation coefficient: 0.91
#'
#' Standard deviation about the function, Sf : 0.411
#'
#' Sf/ Standard deviation about the mean, (\%): 41
#'
#' \strong{Pine, central Sweden}
#' Number of observations: 1631
#'
#' \tabular{lrrrr}{
#' Thinning \tab SI<180 \tab 180≤SI<220 \tab SI≥220  \cr
#' Unthinned \tab 309 \tab 296 \tab 391 \cr
#' Thinned \tab 150 \tab 186 \tab 299 \cr
#' }
#'
#' Multiple correlation coefficient: 0.92
#'
#'
#' Standard deviation about the function, Sf : 0.376
#'
#'
#' Sf/ Standard deviation about the mean, (\%): 39
#'
#' \strong{Pine, southern Sweden}
#' Number of observations: 1631
#'
#' \tabular{lrrrr}{
#' Thinning \tab SI<160 \tab 160≤SI<200 \tab 200≤SI<240 \tab SI≥240  \cr
#' Unthinned \tab 223 \tab 461 \tab 835 \tab 1114 \cr
#' Thinned \tab 84 \tab 244 \tab 523 \tab 656  \cr
#' }
#'
#' Multiple correlation coefficient: 0.92
#'
#'
#' Standard deviation about the function, Sf : 0.409
#'
#'
#' Sf/ Standard deviation about the mean, (\%): 40
#'
#'
#' \strong{Norway Spruce, northern Sweden}
#'
#' Number of observations: 3959
#'
#' \tabular{lrrrr}{
#' Thinning \tab SI<160 \tab 160≤SI<200 \tab SI<200   \cr
#' Unthinned \tab 1405 \tab 1012 \tab 431  \cr
#' Thinned \tab 476 \tab 455 \tab 180 \cr
#' }
#'
#' Multiple correlation coefficient: 0.94
#'
#'
#' Standard deviation about the function, Sf : 0.391
#'
#'
#' Sf/ Standard deviation about the mean, (\%): 36
#'
#' \strong{Norway Spruce, central Sweden}
#'
#' Number of observations: 1773
#'
#' \tabular{lrrrr}{
#' Thinning \tab SI<180 \tab 180≤SI<220 \tab 220≤SI<260 \tab SI≥260  \cr
#' Unthinned \tab 212 \tab 291 \tab 322 \tab 270 \cr
#' Thinned \tab 102 \tab 169 \tab 235 \tab 172  \cr
#' }
#'
#' Multiple correlation coefficient: 0.93
#'
#'
#' Standard deviation about the function, Sf : 0.427
#'
#'
#' Sf/ Standard deviation about the mean, (\%): 39
#'
#'
#' \strong{Norway Spruce, southern Sweden}
#'
#' Number of observations: 4864
#'
#' \tabular{lrrrr}{
#' Thinning \tab SI<220 \tab 220≤SI<260 \tab 260≤SI<300 \tab SI≥300  \cr
#' Unthinned \tab 333 \tab 643 \tab 1121 \tab 1031 \cr
#' Thinned \tab 163 \tab 404 \tab 685 \tab 484  \cr
#' }
#'
#' Multiple correlation coefficient: 0.93
#'
#'
#' Standard deviation about the function, Sf : 0.433
#'
#'
#' Sf/ Standard deviation about the mean, (\%): 48
#'
#' \strong{Birch, northern and central Sweden}
#'
#' Number of observations: 4429
#'
#' \tabular{lrrrr}{
#' Thinning \tab SI<140 \tab 140≤SI<180 \tab 180≤SI<220 \tab SI>220   \cr
#' Unthinned \tab 859 \tab 1157 \tab 792 \tab 482  \cr
#' Thinned \tab 243 \tab 378 \tab 269 \tab 249 \cr
#' }
#'
#' Multiple correlation coefficient: 0.87
#'
#'
#' Standard deviation about the function, Sf : 0.607
#'
#'
#' Sf/ Standard deviation about the mean, (\%): 50
#'
#' \strong{Birch, southern Sweden}
#'
#' Number of observations: 3072
#'
#' \tabular{lrrrr}{
#' Thinning \tab SI<220 \tab 220≤SI<260 \tab 260≤SI<300 \tab SI>300   \cr
#' Unthinned \tab 249 \tab 406 \tab 772 \tab 756  \cr
#' Thinned \tab 89 \tab 181 \tab 334 \tab 285 \cr
#' }
#'
#' Multiple correlation coefficient: 0.88
#'
#'
#' Standard deviation about the function, Sf : 0.599
#'
#'
#' Sf/ Standard deviation about the mean, (\%): 48
#'
#' \strong{Broadleaves, northern and central Sweden}
#' Number of observations: 1367
#'
#' \tabular{lrrrr}{
#' Thinning \tab SI<160 \tab 160≤SI<200 \tab 200≤SI<240 \tab SI>240   \cr
#' Unthinned \tab 319 \tab 335 \tab 225 \tab 160  \cr
#' Thinned \tab 85 \tab 100 \tab 75 \tab 68 \cr
#' }
#'
#' Multiple correlation coefficient: 0.89
#'
#'
#' Standard deviation about the function, Sf : 0.608
#'
#'
#' Sf/ Standard deviation about the mean, (\%): 47
#'
#' \strong{Broadleaves, southern Sweden}
#'
#' Number of observations: 1404
#'
#' \tabular{lrrrr}{
#' Thinning \tab SI<240 \tab 240≤SI<280 \tab 280≤SI<320 \tab SI>320   \cr
#' Unthinned \tab 131 \tab 209 \tab 424 \tab 266 \cr
#' Thinned \tab 60 \tab 75 \tab 151 \tab 88 \cr
#' }
#'
#' Multiple correlation coefficient: 0.90
#'
#'
#' Standard deviation about the function, Sf : 0.622
#'
#'
#' Sf/ Standard deviation about the mean, (\%): 45
#'
#' \strong{Beech}
#' Number of observations: 298
#'
#' \tabular{lrr}{
#' Thinning \tab SI<310 \tab SI≥310 \cr
#' Unthinned \tab 67 \tab 103 \cr
#' Thinned \tab 61 \tab 67 \cr
#' }
#'
#' Multiple correlation coefficient: 0.89
#'
#'
#' Standard deviation about the function, Sf : 0.603
#'
#'
#' Sf/ Standard deviation about the mean, (\%): 46
#'
#' \strong{Oak}
#' Number of observations: 678
#'
#' \tabular{lrrrr}{
#' Thinning \tab SI<280 \tab 280≤SI<320 \tab SI>320   \cr
#' Unthinned \tab 117 \tab 185 \tab 165  \cr
#' Thinned \tab 54 \tab 93 \tab 64 \cr
#' }
#'
#' Multiple correlation coefficient: 0.89
#'
#'
#' Standard deviation about the function, Sf : 0.603
#'
#'
#' Sf/ Standard deviation about the mean, (\%): 46
#'
#'
#' @param basal_area.m2 Basal area over bark (m2/ha)
#' @param stem_number_ha Number of stems per hectare.
#' @param age_at_breast_height Age at breast height, calculated as the mean age of the two thickest trees (years).
#' @param basal_area_other_species Basal area of other species on the plot. (m2/ha)
#' @param SI Site index H100 Pine , m.
#' @param basal_area_weighted_mean_diameter Diameter corresponding to mean basal area (m).
#' @param basal_area_weighted_mean_diameter_other_species Diameter coressponding to mean basal area (m) of other species on plot.
#' @param thinned 1 if the stand been thinned, otherwise 0.
#' @param thinned_previous_5_years 1 if the stand has been thinned within 5 years, otherwise 0.
#' @param vegetation Variable indicating vegetation type scaled from -5 to +4 as follows:
#'
#' \tabular{llr}{
#' Field Layer Code (NFI) \tab Description \tab Index \cr
#' 1\tab Tall herbs w/o dwarf shrubs \tab 4 \cr
#' 2\tab Tall herbs with bilberry \tab 2.5 \cr
#' 3\tab Tall herbs with cowberry \tab 2 \cr
#' 4\tab Low herbs w/o dwarf shrubs \tab 3 \cr
#' 5\tab Low herbs with bilberry \tab 2.5 \cr
#' 6\tab Low herbs with cowberry \tab 2 \cr
#' 7\tab No field layer \tab 3 \cr
#' 8\tab broad-leafed grasses \tab 2.5 \cr
#' 9\tab narrow-leaved grasses \tab 1.5 \cr
#' 10\tab Sedge, tall \tab -3 \cr
#' 11\tab Sedge, low \tab -3 \cr
#' 12\tab Horsetail \tab 1 \cr
#' 13\tab Bilberry \tab 0 \cr
#' 14\tab Cowberry \tab -0.5 \cr
#' 15\tab Crowberry \tab -3 \cr
#' 16\tab Poor shrub \tab -5 \cr
#' 17\tab Lichen-rich \tab -0.5 \cr
#' 18\tab Lichen-dominated \tab -1 \cr
#' }
#' @param south_sweden 1 if the plot is situated in southern Sweden.
#' @param latitude Latitude, degrees.
#' @param soil_moisture Type 1="Dry/torr",2="Mesic/frisk",3="Mesic-moist/frisk-fuktig",4="Moist/fuktig",5="Wet/Blöt"
#' @param altitude Metres above sea level
#' @param TAX77 Always 0 for simulation. Otherwise see original text.
#' @param fertilised 1 if the stand has been fertilised, otherwise 0.
#' @param ba_quotient_chronic_mortality Quotient of basal area (total?) expected to die during the next five-year period, from e.g. crowding, drought (factors that have affected the growth of the stand)
#' @param ba_quotient_acute_mortality Quotient of basal area (total?) expected to die during the next five-year period, from e.g. wind or snowbreak, which do not affect the growth.
#' @return Basal area growth over bark during the five year growth period.
#' @export
#' @name PM_BA
Eko_PM_1985_basal_area_5_year_increment_northern_Sweden_Pine <- function(
  basal_area.m2,
  stem_number_ha,
  age_at_breast_height,
  basal_area_other_species,
  SI,
  basal_area_weighted_mean_diameter,
  basal_area_weighted_mean_diameter_other_species,
  thinned,
  thinned_previous_5_years,
  vegetation,
  south_sweden,
  soil_moisture,
  altitude,
  TAX77=0,
  ba_quotient_chronic_mortality,
  ba_quotient_acute_mortality
){
  SIdm <- SI*10

  ground_veg_indicator <- if(vegetation%in%c(1:6,8,9)){
    1
  } else if(vegetation%in%c(1:9) && south_sweden==TRUE){
    1
  } else {
    0
  }

  if(soil_moisture%in%c(5)){ #vattensjuk eller mycket vattensjuk tolkas som blöt.
    wet <- 1
  } else {
    wet <- 0
  }

  independent_vars <-
    -0.598419*ba_quotient_chronic_mortality+
    -0.486198*ba_quotient_acute_mortality+
    -0.952624E-02*(basal_area_weighted_mean_diameter_other_species/basal_area_weighted_mean_diameter)*basal_area_other_species+
    +0.674527E-01*thinned_previous_5_years+
    +0.100135*ground_veg_indicator+
    -0.104076*wet+
    -0.329437E-01*log(altitude)+
    +0.526479E-01*TAX77+
    +0.164446




  if(SIdm<160){

    if(thinned==0){
dependent_vars <-
    -0.342051E-01*basal_area.m2+
    +0.757840*log(basal_area.m2)+
    -0.161442E-03*stem_number_ha+
    +0.367048*log(stem_number_ha)+
    +0.313386E-02*age_at_breast_height+
    -0.842335*log(age_at_breast_height)+
    -0.157312E-01*basal_area_other_species

    } else {
dependent_vars <-
    -0.222808E-01*basal_area.m2+
    +0.707173*log(basal_area.m2)+
    -0.407064E-03*stem_number_ha+
    +0.386522*log(stem_number_ha)+
    +0.309020E-02*age_at_breast_height+
    -0.840856*log(age_at_breast_height)+
    -0.168721E-01*basal_area_other_species
    }



  } else if(SIdm>=160 && SIdm<200){

    if(thinned==0){
dependent_vars <-

      -0.264194E-01*basal_area.m2+
        +0.759517*log(basal_area.m2)+
        -0.172838E-03*stem_number_ha+
        +0.354319*log(stem_number_ha)+
        +0.282339E-02*age_at_breast_height+
        -0.830969*log(age_at_breast_height)+
        -0.920265E-02*basal_area_other_species

    } else {
dependent_vars <-
      -0.215557E-01*basal_area.m2+
        +0.678298*log(basal_area.m2)+
        -0.223194E-03*stem_number_ha+
        +0.345910*log(stem_number_ha)+
        +0.230893E-02*age_at_breast_height+
        -0.759426*log(age_at_breast_height)+
        -0.129081E-01*basal_area_other_species
    }



  } else if(SIdm>=200){

    if(thinned==0){
dependent_vars <-
      -0.242773E-01*basal_area.m2+
        +0.743286*log(basal_area.m2)+
        -0.127080E-03*stem_number_ha+
        +0.328240*log(stem_number_ha)+
        +0.203892E-02*age_at_breast_height+
        -0.756105*log(age_at_breast_height)+
        -0.136312E-01*basal_area_other_species

    } else {
dependent_vars <-
      -0.100435E-01*basal_area.m2+
        +0.659451*log(basal_area.m2)+
        -0.181913E-03*stem_number_ha+
        +0.369130*log(stem_number_ha)+
        +0.227817E-02*age_at_breast_height+
        -0.793134*log(age_at_breast_height)+
        -0.817145E-02*basal_area_other_species
    }



  }

  return(
    exp(
      dependent_vars + independent_vars + 0.0645
    )
  )



}

#' @rdname PM_BA
#' @export

Eko_PM_1985_basal_area_5_year_increment_central_Sweden_Pine <- function(
    basal_area.m2,
    stem_number_ha,
    age_at_breast_height,
    basal_area_other_species,
    SI,
    basal_area_weighted_mean_diameter,
    basal_area_weighted_mean_diameter_other_species,
    thinned,
    thinned_previous_5_years,
    vegetation,
    south_sweden,
    soil_moisture,
    altitude,
    TAX77=0,
    fertilised,
    ba_quotient_chronic_mortality,
    ba_quotient_acute_mortality
){
  SIdm <- SI*10

  ground_veg_indicator <- if(vegetation%in%c(1:6,8,9)){
    1
  } else if(vegetation%in%c(1:9) && south_sweden==TRUE){
    1
  } else {
    0
  }

  if(soil_moisture==5){ #vattensjuk eller mycket vattensjuk tolkas som blöt.
    wet <- 1
  } else {
    wet <- 0
  }

  if(soil_moisture==1){ #torr eller mycket torr tolkas som torr.
    dry <- 1
  } else {
    dry <- 0
  }

  independent_vars <-
    -0.757422*ba_quotient_chronic_mortality+
    -0.819721*ba_quotient_acute_mortality+
    -0.156937E-01*(basal_area_weighted_mean_diameter_other_species/basal_area_weighted_mean_diameter)*basal_area_other_species+
    +0.657419E-01*fertilised+
    +0.208293E-02*SIdm+
    +0.393424E-01*ground_veg_indicator+
    -0.787040E-01*dry+
    +0.952773E-01*TAX77+
    -0.466279




  if(SIdm<180){

    if(thinned==0){
      dependent_vars <-
        -0.247769E-01*basal_area.m2+
        +0.739123*log(basal_area.m2)+
        -0.724080E-04*stem_number_ha+
        +0.307962*log(stem_number_ha)+
        +0.213813E-02*age_at_breast_height+
        -0.730167*log(age_at_breast_height)+
        -0.304936E-02*basal_area_other_species

    } else {
      dependent_vars <-
        -0.454216E-01*basal_area.m2+
        +0.967594*log(basal_area.m2)+
        +0.134748E-03*stem_number_ha+
        +0.106405*log(stem_number_ha)+
        +0.322181E-02*age_at_breast_height+
        -0.559074*log(age_at_breast_height)+
        -0.146382E-01*basal_area_other_species
    }



  } else if(SIdm>=180 && SIdm<220){

    if(thinned==0){
      dependent_vars <-
        -0.204976E-01*basal_area.m2+
        +0.710569*log(basal_area.m2)+
        -0.331436E-04*stem_number_ha+
        +0.318007*log(stem_number_ha)+
        +0.186999E-02*age_at_breast_height+
        -0.732359*log(age_at_breast_height)+
        -0.488064E-02*basal_area_other_species

    } else {
      dependent_vars <-
        +0.144234E-01*basal_area.m2+
        +0.304194*log(basal_area.m2)+
        -0.111460E-02*stem_number_ha+
        +0.628499*log(stem_number_ha)+
        +0.545633E-02*age_at_breast_height+
        -0.977317*log(age_at_breast_height)+
        -0.126636E-01*basal_area_other_species
    }



  } else if(SIdm>=220){

    if(thinned==0){
      dependent_vars <-
        -0.242132E-01*basal_area.m2+
        +0.746931*log(basal_area.m2)+
        -0.120517E-03*stem_number_ha+
        +0.327216*log(stem_number_ha)+
        +0.254795E-02*age_at_breast_height+
        -0.758639*log(age_at_breast_height)+
        -0.978754E-02*basal_area_other_species

    } else {
      dependent_vars <-
        -0.126617E-01*basal_area.m2+
        +0.599420*log(basal_area.m2)+
        -0.405408E-03*stem_number_ha+
        +0.472836*log(stem_number_ha)+
        +0.455547E-02*age_at_breast_height+
        -0.895734*log(age_at_breast_height)+
        -0.106365E-01*basal_area_other_species
    }



  }

  return(
    exp(
      dependent_vars + independent_vars + 0.0507
    )
  )



}

#' @rdname PM_BA
#' @export
Eko_PM_1985_basal_area_5_year_increment_southern_Sweden_Pine <- function(
    basal_area.m2,
    stem_number_ha,
    age_at_breast_height,
    basal_area_other_species,
    SI,
    basal_area_weighted_mean_diameter,
    basal_area_weighted_mean_diameter_other_species,
    thinned,
    thinned_previous_5_years,
    vegetation,
    south_sweden,
    soil_moisture,
    altitude,
    TAX77=0,
    fertilised,
    latitude,
    ba_quotient_chronic_mortality,
    ba_quotient_acute_mortality
){
  SIdm <- SI*10

  ground_veg_indicator <- if(vegetation%in%c(1:6,8,9)){
    1
  } else if(vegetation%in%c(1:9) && south_sweden==TRUE){
    1
  } else {
    0
  }

  if(soil_moisture==5){ #vattensjuk eller mycket vattensjuk tolkas som blöt.
    wet <- 1
  } else {
    wet <- 0
  }

  if(soil_moisture==1){ #torr eller mycket torr tolkas som torr.
    dry <- 1
  } else {
    dry <- 0
  }

  independent_vars <-
    -1.04202*ba_quotient_chronic_mortality+
    -0.637943*ba_quotient_acute_mortality+
    -1.75160*basal_area_weighted_mean_diameter+
    -0.592599E-02*(basal_area_weighted_mean_diameter_other_species/basal_area_weighted_mean_diameter)*basal_area_other_species+ ## Assuming HKD is a typo and should be HK
    +0.637421E-01*thinned_previous_5_years+
    +0.462966E-01*fertilised+
    +0.522489E-01*ground_veg_indicator+
    -0.702839E-01*dry+
    -0.111568E-01*latitude+
    -0.466973E-01*TAX77




  if(SIdm<160){

    if(thinned==0){
      dependent_vars <-
        -0.497800E-01*basal_area.m2+
        +1.19990*log(basal_area.m2)+
        +0.114548E-04*stem_number_ha+
        +0.164713*log(stem_number_ha)+
        -0.884162E-03*age_at_breast_height+
        -0.564604*log(age_at_breast_height)+
        -0.153879E-01*basal_area_other_species+
        +0.579562

    } else {
      dependent_vars <-
        -0.302305E-01*basal_area.m2+
        +0.938947*log(basal_area.m2)+
        +0.563241E-03*stem_number_ha+
        +0.148914*log(stem_number_ha)+
        +0.419586E-02*age_at_breast_height+
        -1.15586*log(age_at_breast_height)+
        -0.138465E-01*basal_area_other_species+
        +2.72773
    }



  } else if(SIdm>=160 && SIdm<200){
    dependent_vars <-
      if(thinned==0){

        -0.123212E-01*basal_area.m2+
          +0.864851*log(basal_area.m2)+
          -0.497769E-04*stem_number_ha+
          +0.200066*log(stem_number_ha)+
          +0.211976E-02*age_at_breast_height+
          -0.821163*log(age_at_breast_height)+
          -0.941390E-02*basal_area_other_species+
          +1.59527

      } else {
        dependent_vars <-
          -0.216126E-02*basal_area.m2+
          +0.938131*log(basal_area.m2)+
          -0.169034E-03*stem_number_ha+
          +0.621225E-01*log(stem_number_ha)+
          +0.305833E-02*age_at_breast_height+
          -1.18279*log(age_at_breast_height)+
          -0.439063E-03*basal_area_other_species+
          +3.39954
      }



  } else if(SIdm>=200 && SIdm<240){

    if(thinned==0){
      dependent_vars <-
        -0.107718E-01*basal_area.m2+
        +0.796896*log(basal_area.m2)+
        -0.975686E-04*stem_number_ha+
        +0.230066*log(stem_number_ha)+
        -0.577520E-03*age_at_breast_height+
        -0.570857*log(age_at_breast_height)+
        -0.155230E-01*basal_area_other_species+
        +0.784527

    } else {
      dependent_vars <-
        -0.632941E-02*basal_area.m2+
        +0.767710*log(basal_area.m2)+
        -0.173551E-03*stem_number_ha+
        +0.173044*log(stem_number_ha)+
        +0.163026E-02*age_at_breast_height+
        -0.945376*log(age_at_breast_height)+
        -0.133437E-01*basal_area_other_species+
        +2.49514
    }



  } else if(SIdm>=240){

    if(thinned==0){

      dependent_vars <-
        -0.738511E-02*basal_area.m2+
        +0.809028*log(basal_area.m2)+
        -0.207393E-03*stem_number_ha+
        +0.199179*log(stem_number_ha)+
        +0.259619E-03*age_at_breast_height+
        -0.663161*log(age_at_breast_height)+
        -0.142082E-01*basal_area_other_species+
        +1.27892

    } else {
      dependent_vars <-
        -0.207497E-01*basal_area.m2+
        +1.00931*log(basal_area.m2)+
        -0.653755E-05*stem_number_ha+
        +0.851371E-01*log(stem_number_ha)+
        -0.307386E-02*age_at_breast_height+
        -0.635182*log(age_at_breast_height)+
        -0.110970E-01*basal_area_other_species+
        +1.57124
    }



  }

  return(
    exp(
      dependent_vars + independent_vars + 0.0636
    )
  )



}


#' @rdname PM_BA
#' @export
Eko_PM_1985_basal_area_5_year_increment_northern_Sweden_Spruce <- function(
    basal_area.m2,
    stem_number_ha,
    age_at_breast_height,
    basal_area_other_species,
    SI,
    basal_area_weighted_mean_diameter,
    basal_area_weighted_mean_diameter_other_species,
    thinned,
    thinned_previous_5_years,
    vegetation,
    south_sweden,
    soil_moisture,
    altitude,
    TAX77=0,
    fertilised,
    latitude,
    ba_quotient_chronic_mortality=0,
    ba_quotient_acute_mortality=0
    ){
      SIdm <- SI*10

      ground_veg_indicator <- if(vegetation%in%c(1:6,8,9)){
        1
      } else if(vegetation%in%c(1:9) && south_sweden==TRUE){
        1
      } else {
        0
      }

      bilberry_cowberry <- if(vegetation%in%c(13:14)){
        1
      } else {
        0
      }

      if(soil_moisture==5){ #vattensjuk eller mycket vattensjuk tolkas som blöt.
        wet <- 1
      } else {
        wet <- 0
      }

      if(soil_moisture==1){ #torr eller mycket torr tolkas som torr.
        dry <- 1
      } else {
        dry <- 0
      }

      independent_vars <-
        -0.767477*ba_quotient_chronic_mortality+
        -0.514297*ba_quotient_acute_mortality+
        -1.43974*basal_area_weighted_mean_diameter+
        -0.386338E-02*(basal_area_weighted_mean_diameter_other_species/basal_area_weighted_mean_diameter)*basal_area_other_species+
        +0.204732*fertilised+
        +0.186343*ground_veg_indicator+
        +0.392021E-01*bilberry_cowberry+
        -0.807207E-01*dry+
        +0.833252




      if(SIdm<160){

        if(thinned==0){
          dependent_vars <-
            -0.736655E-02*basal_area.m2+
            +0.875788*log(basal_area.m2)+
            -0.642060E-04*stem_number_ha+
            +0.125396*log(stem_number_ha)+
            +0.159356E-02*age_at_breast_height+
            -0.764340*log(age_at_breast_height)+
            -0.594334E-02*basal_area_other_species


        } else {
          dependent_vars <-
            -0.187226-01*basal_area.m2+
            +0.855970*log(basal_area.m2)+
            +0.106942E-03*stem_number_ha+
            +0.107612*log(stem_number_ha)+
            +0.321033E-02*age_at_breast_height+
            -0.737062*log(age_at_breast_height)+
            -0.206053E-01*basal_area_other_species

        }



      } else if(SIdm>=160 && SIdm<200){
        dependent_vars <-
          if(thinned==0){

            -0.191493E-01*basal_area.m2+
              +0.942389*log(basal_area.m2)+
              -0.145476E-03*stem_number_ha+
              +0.158511*log(stem_number_ha)+
              +0.289628E-02*age_at_breast_height+
              -0.804217*log(age_at_breast_height)+
              -0.125949E-01*basal_area_other_species


          } else {
            dependent_vars <-
              -0.255254E-01*basal_area.m2+
              +0.955380*log(basal_area.m2)+
              -0.642149E-04*stem_number_ha+
              +0.164265*log(stem_number_ha)+
              +0.554025E-02*age_at_breast_height+
              -0.866520*log(age_at_breast_height)+
              -0.889755E-02*basal_area_other_species

          }



      } else if(SIdm>=200){

        if(thinned==0){
          dependent_vars <-
            -0.210737E-01*basal_area.m2+
            +0.932275*log(basal_area.m2)+
            -0.572335E-04*stem_number_ha+
            +0.152017*log(stem_number_ha)+
            +0.342622E-02*age_at_breast_height+
            -0.811183*log(age_at_breast_height)+
            -0.905176E-02*basal_area_other_species


        } else {
          dependent_vars <-
            -0.133941E-01*basal_area.m2+
            +0.837783*log(basal_area.m2)+
            -0.245946E-03*stem_number_ha+
            +0.205142*log(stem_number_ha)+
            +0.602419E-02*age_at_breast_height+
            -0.862195*log(age_at_breast_height)+
            -0.135941E-01*basal_area_other_species

        }



      }

      return(
        exp(
          dependent_vars + independent_vars + 0.0564
        )
      )



    }

#' @rdname PM_BA
#' @export
Eko_PM_1985_basal_area_5_year_increment_central_Sweden_Spruce <- function(
    basal_area.m2,
    stem_number_ha,
    age_at_breast_height,
    basal_area_other_species,
    SI,
    basal_area_weighted_mean_diameter,
    basal_area_weighted_mean_diameter_other_species,
    thinned,
    thinned_previous_5_years,
    vegetation,
    south_sweden,
    soil_moisture,
    altitude,
    TAX77=0,
    fertilised,
    latitude,
    ba_quotient_chronic_mortality,
    ba_quotient_acute_mortality
){
  SIdm <- SI*10

  ground_veg_indicator <- if(vegetation%in%c(1:6,8,9)){
    1
  } else if(vegetation%in%c(1:9) && south_sweden==TRUE){
    1
  } else {
    0
  }

  if(soil_moisture==5){ #vattensjuk eller mycket vattensjuk tolkas som blöt.
    wet <- 1
  } else {
    wet <- 0
  }

  if(soil_moisture==1){ #torr eller mycket torr tolkas som torr.
    dry <- 1
  } else {
    dry <- 0
  }

  independent_vars <-
    -1.16597*ba_quotient_chronic_mortality+
    -0.299327*ba_quotient_acute_mortality+
    +0.783806E-01*thinned_previous_5_years+
    +0.572131E-01*ground_veg_indicator+
    -0.112938E-01*wet+ #Typo in book. No number or sign after E. Assuming -1.
    +0.546176E-01*latitude+
    +0.332621E-01*TAX77




  if(SIdm<180){

    if(thinned==0){
      dependent_vars <-
        -0.802837E-02*basal_area.m2+
        +0.751220*log(basal_area.m2)+
        -0.800241E-04*stem_number_ha+
        +0.239814*log(stem_number_ha)+
        -0.148757E-02*age_at_breast_height+
        -0.476534*log(age_at_breast_height)+
        -0.308451E-01*basal_area_other_species+
        -4.02484

    } else {
      dependent_vars <-
        -0.330623E-01*basal_area.m2+
        +1.06539*log(basal_area.m2)+
        +0.145290E-03*stem_number_ha+
        +0.422450E-01*log(stem_number_ha)+
        +0.110998E-01*age_at_breast_height+
        -1.71468*log(age_at_breast_height)+
        -0.236447E-01*basal_area_other_species+
        +1.06383
    }



  } else if(SIdm>=180 && SIdm<220){
    dependent_vars <-
      if(thinned==0){

        -0.211171E-01*basal_area.m2+
          +0.837241*log(basal_area.m2)+
          -0.800241E-04*stem_number_ha+
          +0.239814*log(stem_number_ha)+
          +0.492578E-02*age_at_breast_height+
          -0.839650*log(age_at_breast_height)+
          -0.269523E-02*basal_area_other_species+
          -2.91926

      } else {
        dependent_vars <-
          -0.180419E-01*basal_area.m2+
          +0.943986*log(basal_area.m2)+
          +0.145290E-03*stem_number_ha+
          +0.422450E-01*log(stem_number_ha)+
          +0.525585E-02*age_at_breast_height+
          -0.982261*log(age_at_breast_height)+
          -0.786807E-02*basal_area_other_species+
          -1.56544
      }



  } else if(SIdm>=220 && SIdm<260){

    if(thinned==0){
      dependent_vars <-
        -0.263745E-01*basal_area.m2+
        +0.915196*log(basal_area.m2)+
        -0.800241E-04*stem_number_ha+
        +0.239814*log(stem_number_ha)+
        -0.384471E-02*age_at_breast_height+
        -0.847753*log(age_at_breast_height)+
        -0.252559E-01*basal_area_other_species+
        +2.85518

    } else {
      dependent_vars <-
        -0.217674E-01*basal_area.m2+
        +0.847682*log(basal_area.m2)+
        -0.145290E-03*stem_number_ha+
        +0.422450E-01*log(stem_number_ha)+
        +0.101626E-01*age_at_breast_height+
        -1.37782*log(age_at_breast_height)+
        -0.268779E-01*basal_area_other_species+
        +0.178428
    }



  } else if(SIdm>=260){

    if(thinned==0){

      dependent_vars <-
        -0.244742E-01*basal_area.m2+
        +0.787195*log(basal_area.m2)+
        -0.800241E-04*stem_number_ha+
        +0.239814*log(stem_number_ha)+
        +0.371613E-02*age_at_breast_height+
        -0.561641*log(age_at_breast_height)+
        -0.298097E-01*basal_area_other_species+
        -3.17570

    } else {
      dependent_vars <-
        -0.239679E-01*basal_area.m2+
        +0.924765*log(basal_area.m2)+
        +0.145290E-03*stem_number_ha+
        +0.422450E-01*log(stem_number_ha)+
        +0.631561E-03*age_at_breast_height+
        -0.893401*log(age_at_breast_height)+
        -0.908286E-02*basal_area_other_species+
        -1.46143
    }



  }

  return(
    exp(
      dependent_vars + independent_vars + 0.0712
    )
  )



}

#' @rdname PM_BA
#' @export
Eko_PM_1985_basal_area_5_year_increment_southern_Sweden_Spruce <- function(
    basal_area.m2,
    stem_number_ha,
    age_at_breast_height,
    basal_area_other_species,
    SI,
    basal_area_weighted_mean_diameter,
    basal_area_weighted_mean_diameter_other_species,
    thinned,
    thinned_previous_5_years,
    vegetation,
    south_sweden,
    soil_moisture,
    altitude,
    TAX77=0,
    fertilised,
    latitude,
    ba_quotient_chronic_mortality,
    ba_quotient_acute_mortality
    ){
      SIdm <- SI*10

      ground_veg_indicator <- if(vegetation%in%c(1:6,8,9)){
        1
      } else if(vegetation%in%c(1:9) && south_sweden==TRUE){
        1
      } else {
        0
      }

      if(soil_moisture==5){ #vattensjuk eller mycket vattensjuk tolkas som blöt.
        wet <- 1
      } else {
        wet <- 0
      }

      if(soil_moisture==1){ #torr eller mycket torr tolkas som torr.
        dry <- 1
      } else {
        dry <- 0
      }

      independent_vars <-
        -0.780391*ba_quotient_chronic_mortality+
        -0.252170*ba_quotient_acute_mortality+
        -0.318464E-01*thinned_previous_5_years+
        +0.778093E-01 *fertilised+
        +0.127135E-02*SIdm+
        +0.262484E-01*ground_veg_indicator+
        -0.736690E-01*dry+
        -0.269193E-01*latitude+
        -0.959785E-01*TAX77




      if(SIdm<220){

        if(thinned==0){
          dependent_vars <-
            -0.149200E-01*basal_area.m2+
            +0.794859*log(basal_area.m2)+
            -0.120956E-03*stem_number_ha+
            +0.255053*log(stem_number_ha)+
            -0.720252*log(age_at_breast_height)+
            -0.229139E-01*basal_area_other_species+
            +1.52732

        } else {
          dependent_vars <-
            -0.227763E-01*basal_area.m2+
            +0.838105*log(basal_area.m2)+
            +0.519813E-03*stem_number_ha+
            +0.141232*log(stem_number_ha)+
            -0.722723*log(age_at_breast_height)+
            -0.237689E-01*basal_area_other_species+
            +1.93218
        }



      } else if(SIdm>=220 && SIdm<260){

        if(thinned==0){
          dependent_vars <-
            -0.167127E-01*basal_area.m2+
            +0.794738*log(basal_area.m2)+
            -0.923244E-04*stem_number_ha+
            +0.279717*log(stem_number_ha)+
            -0.790588*log(age_at_breast_height)+
            -0.187801E-01*basal_area_other_species+
            +1.67230

        } else {
          dependent_vars <-
            -0.167448E-01*basal_area.m2+
            +0.835811*log(basal_area.m2)+
            -0.995431E-04*stem_number_ha+
            +0.258612*log(stem_number_ha)+
            -0.931549*log(age_at_breast_height)+
            -0.167010E-01*basal_area_other_species+
            +2.34225
        }



      } else if(SIdm>=260 && SIdm<300){

        if(thinned==0){

          dependent_vars <-
            -0.221875E-01*basal_area.m2+
            +0.832287*log(basal_area.m2)+
            -0.110872E-03*stem_number_ha+
            +0.271386*log(stem_number_ha)+
            -0.735989*log(age_at_breast_height)+
            -0.196143E-01*basal_area_other_species+
            +1.50310

        } else {
          dependent_vars <-
            -0.203970E-01*basal_area.m2+
            +0.836890*log(basal_area.m2)+
            -0.755155E-04*stem_number_ha+
            +0.248563*log(stem_number_ha)+
            -0.716504*log(age_at_breast_height)+
            -0.151436E-01*basal_area_other_species+
            +1.50719
        }



      } else if(SIdm>=300){

        if(thinned==0){

          dependent_vars <-
            -0.243263E-01*basal_area.m2+
            +0.902730*log(basal_area.m2)+
            -0.706319E-04*stem_number_ha+
            +0.198283*log(stem_number_ha)+
            -0.713230*log(age_at_breast_height)+
            -0.135840E-01*basal_area_other_species+
            +1.71136

        } else {
          dependent_vars <-
            -0.218319E-01*basal_area.m2+
            +0.855200*log(basal_area.m2)+
            -0.176554E-03*stem_number_ha+
            +0.269091*log(stem_number_ha)+
            -0.765104*log(age_at_breast_height)+
            -0.180257E-01*basal_area_other_species+
            +1.62508
        }



      }

      return(
        exp(
          dependent_vars + independent_vars + 0.0737
        )
      )



    }

#' @rdname PM_BA
#' @export
Eko_PM_1985_basal_area_5_year_increment_northern_central_Sweden_Birch <- function(
    basal_area.m2,
    stem_number_ha,
    age_at_breast_height,
    basal_area_other_species,
    SI,
    basal_area_weighted_mean_diameter,
    basal_area_weighted_mean_diameter_other_species,
    thinned,
    thinned_previous_5_years,
    vegetation,
    south_sweden,
    soil_moisture,
    altitude,
    TAX77=0,
    fertilised,
    latitude,
    ba_quotient_chronic_mortality,
    ba_quotient_acute_mortality
    ){
      SIdm <- SI*10

      ground_veg_indicator <- if(vegetation%in%c(1:6,8,9)){
        1
      } else if(vegetation%in%c(1:9) && south_sweden==TRUE){
        1
      } else {
        0
      }

      bilberry_cowberry <- if(vegetation%in%c(13:14)){
        1
      } else {
        0
      }

      if(soil_moisture==5){ #vattensjuk eller mycket vattensjuk tolkas som blöt.
        wet <- 1
      } else {
        wet <- 0
      }

      if(soil_moisture==1){ #torr eller mycket torr tolkas som torr.
        dry <- 1
      } else {
        dry <- 0
      }

      independent_vars <-
        -0.474848*ba_quotient_chronic_mortality+
        -0.207333*ba_quotient_acute_mortality+
        -0.202362E-02*(basal_area_weighted_mean_diameter_other_species/basal_area_weighted_mean_diameter)*basal_area_other_species+
        +0.914442E-01*thinned_previous_5_years
      +0.176843*fertilised+
        +0.256714*ground_veg_indicator+
        -0.488706E-01*wet+
        -0.139928E-01*latitude+
        -0.462992*altitude+
        +0.189383*TAX77




      if(SIdm<140){

        if(thinned==0){
          dependent_vars <-
            +0.281210E-02*basal_area.m2+
            +0.718062*log(basal_area.m2)+
            -0.264120E-03*stem_number_ha+
            +0.360947*log(stem_number_ha)+
            -0.513560*log(age_at_breast_height)+
            -0.146581E-01*basal_area_other_species+
            -0.768510


        } else {
          dependent_vars <-
            +0.856585-01*basal_area.m2+
            +0.488507*log(basal_area.m2)+
            -0.549010E-03*stem_number_ha+
            +0.467588*log(stem_number_ha)+
            -0.618645*log(age_at_breast_height)+
            -0.477226E-02*basal_area_other_species+
            -0.768510
        }



      } else if(SIdm>=140 && SIdm<180){

        if(thinned==0){
          dependent_vars <-

            +0.831133E-02*basal_area.m2+
            +0.660201*log(basal_area.m2)+
            -0.161770E-03*stem_number_ha+
            +0.361272*log(stem_number_ha)+
            -0.609806*log(age_at_breast_height)+
            -0.133204E-01*basal_area_other_species+
            -0.355882


        } else {
          dependent_vars <-
            +0.665931E-02*basal_area.m2+
            +0.700295*log(basal_area.m2)+
            -0.221485E-03*stem_number_ha+
            +0.316196*log(stem_number_ha)+
            -0.489888*log(age_at_breast_height)+
            -0.246752E-01*basal_area_other_species+
            -0.355882

        }



      } else if(SIdm>=180 && SIdm<220){

        if(thinned==0){
          dependent_vars <-
            -0.371203E-02*basal_area.m2+
            +0.835899*log(basal_area.m2)+
            -0.141238E-03*stem_number_ha+
            +0.221611*log(stem_number_ha)+
            -0.732659*log(age_at_breast_height)+
            -0.131446E-01*basal_area_other_species+
            +0.891049


        } else {
          dependent_vars <-
            -0.134251E-02*basal_area.m2+
            +0.838751*log(basal_area.m2)+
            -0.237653E-03*stem_number_ha+
            +0.192259*log(stem_number_ha)+
            -0.707746*log(age_at_breast_height)+
            -0.499067E-02*basal_area_other_species+
            +0.891049

        }

      } else if(SIdm>=220){

        if(thinned==0){
          dependent_vars <-
            -0.281602E-01*basal_area.m2+
            +0.800357*log(basal_area.m2)+
            +0.673284E-04*stem_number_ha+
            +0.205233*log(stem_number_ha)+
            -0.631139*log(age_at_breast_height)+
            -0.176494E-01*basal_area_other_species+
            +0.731245


        } else {
          dependent_vars <-
            -0.177526E-01*basal_area.m2+
            +0.814686*log(basal_area.m2)+
            +0.781625E-04*stem_number_ha+
            +0.183532*log(stem_number_ha)+
            -0.593656*log(age_at_breast_height)+
            -0.211444E-01*basal_area_other_species+
            +0.731245

        }



      }

      return(
        exp(
          dependent_vars + independent_vars + 0.1642
        )
      )

}

#' @rdname PM_BA
#' @export
Eko_PM_1985_basal_area_5_year_increment_southern_Sweden_Birch <- function(
    basal_area.m2,
    stem_number_ha,
    age_at_breast_height,
    basal_area_other_species,
    SI,
    basal_area_weighted_mean_diameter,
    basal_area_weighted_mean_diameter_other_species,
    thinned,
    thinned_previous_5_years,
    vegetation,
    south_sweden,
    soil_moisture,
    altitude,
    TAX77=0,
    fertilised,
    latitude,
    ba_quotient_chronic_mortality,
    ba_quotient_acute_mortality
){
  SIdm <- SI*10

  ground_veg_indicator <- if(vegetation%in%c(1:6,8,9)){
    1
  } else if(vegetation%in%c(1:9) && south_sweden==TRUE){
    1
  } else {
    0
  }

  bilberry_cowberry <- if(vegetation%in%c(13:14)){
    1
  } else {
    0
  }

  if(soil_moisture==5){ #vattensjuk eller mycket vattensjuk tolkas som blöt.
    wet <- 1
  } else {
    wet <- 0
  }

  if(soil_moisture==1){ #torr eller mycket torr tolkas som torr.
    dry <- 1
  } else {
    dry <- 0
  }

  independent_vars <-
    -0.617367*ba_quotient_chronic_mortality+
    -0.350920*ba_quotient_acute_mortality+
    -0.134245E-02*(basal_area_weighted_mean_diameter_other_species/basal_area_weighted_mean_diameter)*basal_area_other_species+
    +0.277904*fertilised+
    +0.154562*ground_veg_indicator+
    +0.554711E-01*TAX77




  if(SIdm<220){

    if(thinned==0){
      dependent_vars <-
        -0.850224E-02*basal_area.m2+
        +0.931518*log(basal_area.m2)+
        -0.874696E-04*stem_number_ha+
        +0.124964*log(stem_number_ha)+
        -0.890226E-02*age_at_breast_height+
        -0.498825*log(age_at_breast_height)+
        -0.493910E-02*basal_area_other_species+
        -0.135041


    } else {
      dependent_vars <-
        +0.144427*basal_area.m2+
        +0.332109*log(basal_area.m2)+
        -0.457988E-03*stem_number_ha+
        +0.474159*log(stem_number_ha)+
        +0.922378E-02*age_at_breast_height+
        -1.50315*log(age_at_breast_height)+
        -0.116043E-01*basal_area_other_species+
        +1.19213
    }



  } else if(SIdm>=220 && SIdm<260){
    if(thinned==0){
      dependent_vars <-

        +0.129783E-01*basal_area.m2+
        +0.688150*log(basal_area.m2)+
        -0.158067E-03*stem_number_ha+
        +0.304149*log(stem_number_ha)+
        +0.411176E-02*age_at_breast_height+
        -0.864501*log(age_at_breast_height)+
        -0.533730E-02*basal_area_other_species+
        -0.135041

    } else {
      dependent_vars <-
        -0.235447E-01*basal_area.m2+
        +0.962877*log(basal_area.m2)+
        +0.103737E-03*stem_number_ha+
        +0.186790*log(stem_number_ha)+
        -0.127109E-02*age_at_breast_height+
        -1.02854*log(age_at_breast_height)+
        -0.849201E-02*basal_area_other_species+
        +1.19213

    }



  } else if(SIdm>=260 && SIdm<300){

    if(thinned==0){
      dependent_vars <-
        -0.110984E-01*basal_area.m2+
        +0.748193*log(basal_area.m2)+
        -0.434390E-04*stem_number_ha+
        +0.270476*log(stem_number_ha)+
        +0.823613E-03*age_at_breast_height+
        -0.718419*log(age_at_breast_height)+
        -0.174522E-01*basal_area_other_species+
        -0.135041


    } else {
      dependent_vars <-
        -0.438786E-03*basal_area.m2+
        +0.818427*log(basal_area.m2)+
        -0.304146E-03*stem_number_ha+
        +0.241055*log(stem_number_ha)+
        +0.106700E-01*age_at_breast_height+
        -1.16385*log(age_at_breast_height)+
        -0.1978220E-01*basal_area_other_species+
        +1.19213

    }

  } else if(SIdm>=300){

    if(thinned==0){
      dependent_vars <-
        -0.204315E-01*basal_area.m2+
        +0.792798*log(basal_area.m2)+
        -0.179026E-03*stem_number_ha+
        +0.316913*log(stem_number_ha)+
        +0.262117E-02*age_at_breast_height+
        -0.791796*log(age_at_breast_height)+
        -0.146037E-01*basal_area_other_species+
        -0.135041


    } else {
      dependent_vars <-
        +0.255898E-02*basal_area.m2+
        +0.730671*log(basal_area.m2)+
        +0.256307E-04*stem_number_ha+
        +0.256131*log(stem_number_ha)+
        +0.126785E-01*age_at_breast_height+
        -1.24005*log(age_at_breast_height)+
        -0.341768E-02*basal_area_other_species+
        +1.19213

    }



  }

  return(
    exp(
      dependent_vars + independent_vars + 0.1590
    )
  )



}


#' @rdname PM_BA
#' @export
Eko_PM_1985_basal_area_5_year_increment_northern_central_Sweden_Broadleaves <- function(
    basal_area.m2,
    stem_number_ha,
    age_at_breast_height,
    basal_area_other_species,
    SI,
    basal_area_weighted_mean_diameter,
    basal_area_weighted_mean_diameter_other_species,
    thinned,
    thinned_previous_5_years,
    vegetation,
    south_sweden,
    soil_moisture,
    altitude,
    TAX77=0,
    fertilised,
    latitude,
    ba_quotient_chronic_mortality
){
  SIdm <- SI*10

  ground_veg_indicator <- if(vegetation%in%c(1:6,8,9)){
    1
  } else if(vegetation%in%c(1:9) && south_sweden==TRUE){
    1
  } else {
    0
  }

  bilberry_cowberry <- if(vegetation%in%c(13:14)){
    1
  } else {
    0
  }

  if(soil_moisture==5){ #vattensjuk eller mycket vattensjuk tolkas som blöt.
    wet <- 1
  } else {
    wet <- 0
  }

  if(soil_moisture==1){ #torr eller mycket torr tolkas som torr.
    dry <- 1
  } else {
    dry <- 0
  }

  independent_vars <-
    -0.345933*ba_quotient_chronic_mortality+
    -0.138015*ground_veg_indicator+
    -0.650878E-01*bilberry_cowberry+
    -0.175149E-01*latitude+
    -0.570035E-03*altitude+
    +0.151318*TAX77




  if(SIdm<160){

    if(thinned==0){
      dependent_vars <-
        +0.865166E-01*basal_area.m2+
        +0.755603*log(basal_area.m2)+
        -0.806548E-03*stem_number_ha+
        +0.275974*log(stem_number_ha)+
        -0.540881E-02*age_at_breast_height+
        -0.117056*log(age_at_breast_height)+
        -0.187866E-01*basal_area_other_species+
        -1.18519


    } else {
      dependent_vars <-
        +0.865166E-01*basal_area.m2+
        +0.755603*log(basal_area.m2)+
        -0.806548E-03*stem_number_ha+
        +0.275974*log(stem_number_ha)+
        -0.540881E-02*age_at_breast_height+
        -0.117056*log(age_at_breast_height)+
        -0.187866E-01*basal_area_other_species+
        -0.952398
    }



  } else if(SIdm>=160 && SIdm<200){
    if(thinned==0){
      dependent_vars <-
        -0.129773E-01*basal_area.m2+
        +0.989525*log(basal_area.m2)+
        -0.715363E-04*stem_number_ha+
        +0.490676E-01*log(stem_number_ha)+
        +0.218728E-02*age_at_breast_height+
        -0.944317*log(age_at_breast_height)+
        -0.143834E-01*basal_area_other_species+
        +2.78296

    } else {
      dependent_vars <-
        -0.129773E-01*basal_area.m2+
        +0.989525*log(basal_area.m2)+
        -0.715363E-04*stem_number_ha+
        +0.490676E-01*log(stem_number_ha)+
        +0.218728E-02*age_at_breast_height+
        -0.944317*log(age_at_breast_height)+
        -0.143834E-01*basal_area_other_species+
        +2.87671

    }



  } else if(SIdm>=200 && SIdm<240){

    if(thinned==0){
      dependent_vars <-
        +0.517826E-01*basal_area.m2+
        +0.768565*log(basal_area.m2)+
        -0.381320E-03*stem_number_ha+
        +0.201267*log(stem_number_ha)+
        +0.131078E-02*age_at_breast_height+
        -0.831523*log(age_at_breast_height)+
        -0.122796E-01*basal_area_other_species+
        +1.65650


    } else {
      dependent_vars <-
        +0.517826E-01*basal_area.m2+
        +0.768565*log(basal_area.m2)+
        -0.381320E-03*stem_number_ha+
        +0.201267*log(stem_number_ha)+
        +0.131078E-02*age_at_breast_height+
        -0.831523*log(age_at_breast_height)+
        -0.122796E-01*basal_area_other_species+
        +1.59209
    }

  } else if(SIdm>=240){

    if(thinned==0){
      dependent_vars <-
        +0.243920E-02*basal_area.m2+
        +0.857832*log(basal_area.m2)+
        -0.949555E-04*stem_number_ha+
        +0.192173*log(stem_number_ha)+
        -0.292753E-02*age_at_breast_height+
        -0.570009*log(age_at_breast_height)+
        -0.240816E-01*basal_area_other_species+
        +0.916942


    } else {
      dependent_vars <-
        +0.243920E-02*basal_area.m2+
        +0.857832*log(basal_area.m2)+
        -0.949555E-04*stem_number_ha+
        +0.192173*log(stem_number_ha)+
        -0.292753E-02*age_at_breast_height+
        -0.570009*log(age_at_breast_height)+
        -0.240816E-01*basal_area_other_species+
        +1.17865

    }



  }

  return(
    exp(
      dependent_vars + independent_vars + 0.1648
    )
  )



}


#' @rdname PM_BA
#' @export
Eko_PM_1985_basal_area_5_year_increment_southern_Sweden_Broadleaves <- function(
    basal_area.m2,
    stem_number_ha,
    age_at_breast_height,
    basal_area_other_species,
    SI,
    basal_area_weighted_mean_diameter,
    basal_area_weighted_mean_diameter_other_species,
    thinned,
    thinned_previous_5_years,
    vegetation,
    south_sweden,
    soil_moisture,
    altitude,
    TAX77=0,
    fertilised,
    latitude,
    ba_quotient_chronic_mortality,
    ba_quotient_acute_mortality
){
  SIdm <- SI*10

  ground_veg_indicator <- if(vegetation%in%c(1:6,8,9)){
    1
  } else if(vegetation%in%c(1:9) && south_sweden==TRUE){
    1
  } else {
    0
  }

  bilberry_cowberry <- if(vegetation%in%c(13:14)){
    1
  } else {
    0
  }

  if(soil_moisture==5){ #vattensjuk eller mycket vattensjuk tolkas som blöt.
    wet <- 1
  } else {
    wet <- 0
  }

  if(soil_moisture==1){ #torr eller mycket torr tolkas som torr.
    dry <- 1
  } else {
    dry <- 0
  }

  independent_vars <-
    -1.20049*ba_quotient_chronic_mortality+
    -0.367064*ba_quotient_acute_mortality+
    +0.125048*thinned_previous_5_years+
    +0.246684*fertilised+
    +0.141955*ground_veg_indicator+
    +0.354866E-01*latitude+
    -0.361988E-03*altitude




  if(SIdm<240){

    if(thinned==0){
      dependent_vars <-
        +0.857153*log(basal_area.m2)+
        -0.541853E-04*stem_number_ha+
        +0.152684*log(stem_number_ha)+
        -0.803085E-02*age_at_breast_height+
        -0.570230*log(age_at_breast_height)+
        -0.100518*log(basal_area_other_species)+ #assuming KG is GK typo.
        -1.93895


    } else {
      dependent_vars <-
        +0.857153*log(basal_area.m2)+
        -0.541853E-04*stem_number_ha+
        +0.152684*log(stem_number_ha)+
        -0.803085E-02*age_at_breast_height+
        -0.570230*log(age_at_breast_height)+
        -0.100518*log(basal_area_other_species)+ #assuming KG is GK typo.
        -2.01960
    }



  } else if(SIdm>=240 && SIdm<280){
    if(thinned==0){
      dependent_vars <-
        +0.794405*log(basal_area.m2)+
        -0.247009*stem_number_ha+
        +0.202344*log(stem_number_ha)+
        -0.250423*age_at_breast_height+
        -0.669629*log(age_at_breast_height)+
        -0.101205*log(basal_area_other_species)+ #assuming KG is GK typo.
        -1.93895

    } else {
      dependent_vars <-
        +0.794405*log(basal_area.m2)+
        -0.247009*stem_number_ha+
        +0.202344*log(stem_number_ha)+
        -0.250423*age_at_breast_height+
        -0.669629*log(age_at_breast_height)+
        -0.101205*log(basal_area_other_species)+ #assuming KG is GK typo.
        -2.01960

    }



  } else if(SIdm>=280 && SIdm<320){

    if(thinned==0){
      dependent_vars <-
        +0.782374*log(basal_area.m2)+
        -0.125111E-03*stem_number_ha+
        +0.239626*log(stem_number_ha)+
        -0.787146E-03*age_at_breast_height+
        -0.733575*log(age_at_breast_height)+
        -0.823802E-01*log(basal_area_other_species)+ #assuming KG is GK typo.
        -1.93895


    } else {
      dependent_vars <-
        +0.782374*log(basal_area.m2)+
        -0.125111E-03*stem_number_ha+
        +0.239626*log(stem_number_ha)+
        -0.787146E-03*age_at_breast_height+
        -0.733575*log(age_at_breast_height)+
        -0.823802E-01*log(basal_area_other_species)+ #assuming KG is GK typo.
        -2.01960
    }

  } else if(SIdm>=320){

    if(thinned==0){
      dependent_vars <-
        +0.771398*log(basal_area.m2)+
        +0.427071E-04*stem_number_ha+
        +0.167037*log(stem_number_ha)+
        -0.190695E-02*age_at_breast_height+
        -0.587696*log(age_at_breast_height)+
        -0.113489*log(basal_area_other_species)+ #assuming KG is GK typo.
        -1.93895


    } else {
      dependent_vars <-
        +0.771398*log(basal_area.m2)+
        +0.427071E-04*stem_number_ha+
        +0.167037*log(stem_number_ha)+
        -0.190695E-02*age_at_breast_height+
        -0.587696*log(age_at_breast_height)+
        -0.113489*log(basal_area_other_species)+ #assuming KG is GK typo.
        -2.01960

    }



  }

  return(
    exp(
      dependent_vars + independent_vars + 0.1734
    )
  )



}


#' @rdname PM_BA
#' @export
Eko_PM_1985_basal_area_5_year_increment_Sweden_Beech <- function(
    basal_area.m2,
    stem_number_ha,
    age_at_breast_height,
    basal_area_other_species,
    SI,
    basal_area_weighted_mean_diameter,
    basal_area_weighted_mean_diameter_other_species,
    thinned,
    thinned_previous_5_years,
    vegetation,
    south_sweden,
    soil_moisture,
    altitude,
    TAX77=0,
    fertilised,
    latitude,
    ba_quotient_acute_mortality
){
  SIdm <- SI*10

  ground_veg_indicator <- if(vegetation%in%c(1:6,8,9)){
    1
  } else if(vegetation%in%c(1:9) && south_sweden==TRUE){
    1
  } else {
    0
  }

  bilberry_cowberry <- if(vegetation%in%c(13:14)){
    1
  } else {
    0
  }

  if(soil_moisture==5){ #vattensjuk eller mycket vattensjuk tolkas som blöt.
    wet <- 1
  } else {
    wet <- 0
  }

  if(soil_moisture==1){ #torr eller mycket torr tolkas som torr.
    dry <- 1
  } else {
    dry <- 0
  }

  independent_vars <-
    -0.862301*ba_quotient_acute_mortality+
    +0.162579E-02*SIdm+
    +0.538943




  if(SIdm<310){

    if(thinned==0){
      dependent_vars <-
        +0.948126*log(basal_area.m2)+
        +0.563620E-01*log(stem_number_ha)+
        -0.751665*log(age_at_breast_height)+
        -0.163302E-01*basal_area_other_species


    } else {
      dependent_vars <-
        +0.948126*log(basal_area.m2)+
        +0.563620E-01*log(stem_number_ha)+
        -0.751665*log(age_at_breast_height)+
        -0.163302E-01*basal_area_other_species+
        +0.887110E-01
    }



  } else if(SIdm>=310){
    if(thinned==0){
      dependent_vars <-
        +0.821914*log(basal_area.m2)+
        +0.102770*log(stem_number_ha)+
        -0.753735*log(age_at_breast_height)+
        -0.163641E-01*basal_area_other_species

    } else {
      dependent_vars <-
        +0.821914*log(basal_area.m2)+
        +0.102770*log(stem_number_ha)+
        -0.753735*log(age_at_breast_height)+
        -0.163641E-01*basal_area_other_species+
        +0.887110E-01

    }



  }

  return(
    exp(
      dependent_vars + independent_vars + 0.1379
    )
  )



}


#' @rdname PM_BA
#' @export
Eko_PM_1985_basal_area_5_year_increment_Sweden_Oak <- function(
    basal_area.m2,
    stem_number_ha,
    age_at_breast_height,
    basal_area_other_species,
    SI,
    basal_area_weighted_mean_diameter,
    basal_area_weighted_mean_diameter_other_species,
    thinned,
    thinned_previous_5_years,
    vegetation,
    south_sweden,
    soil_moisture,
    altitude,
    TAX77=0,
    fertilised,
    latitude,
    ba_quotient_acute_mortality
){
  SIdm <- SI*10

  ground_veg_indicator <- if(vegetation%in%c(1:6,8,9)){
    1
  } else if(vegetation%in%c(1:9) && south_sweden==TRUE){
    1
  } else {
    0
  }

  bilberry_cowberry <- if(vegetation%in%c(13:14)){
    1
  } else {
    0
  }

  if(soil_moisture==5){ #vattensjuk eller mycket vattensjuk tolkas som blöt.
    wet <- 1
  } else {
    wet <- 0
  }

  if(soil_moisture==1){ #torr eller mycket torr tolkas som torr.
    dry <- 1
  } else {
    dry <- 0
  }

  independent_vars <-
    -0.389169*ba_quotient_acute_mortality+
    -0.609667




  if(SIdm<280){

    if(thinned==0){
      dependent_vars <-
        +0.896599*log(basal_area.m2)+
        +0.199354*log(stem_number_ha)+
        -0.842665*log(age_at_breast_height)+
        -0.146432E-01*basal_area_other_species


    } else {
      dependent_vars <-
        +0.896599*log(basal_area.m2)+
        +0.199354*log(stem_number_ha)+
        -0.842665*log(age_at_breast_height)+
        -0.146432E-01*basal_area_other_species
    }



  } else if(SIdm>=280 && SIdm<320){
    if(thinned==0){
      dependent_vars <-
        +0.847420*log(basal_area.m2)+
        +0.144495*log(stem_number_ha)+
        -0.727278*log(age_at_breast_height)+
        -0.222990E-01*basal_area_other_species

    } else {
      dependent_vars <-
        +0.847420*log(basal_area.m2)+
        +0.144495*log(stem_number_ha)+
        -0.727278*log(age_at_breast_height)+
        -0.222990E-01*basal_area_other_species

    }



  } else if(SIdm>=320){

    if(thinned==0){
      dependent_vars <-
        +0.851362*log(basal_area.m2)+
        +0.128100*log(stem_number_ha)+
        -0.667346*log(age_at_breast_height)+
        -0.199705E-01*basal_area_other_species


    } else {
      dependent_vars <-
        +0.851362*log(basal_area.m2)+
        +0.128100*log(stem_number_ha)+
        -0.667346*log(age_at_breast_height)+
        -0.199705E-01*basal_area_other_species

    }

  }

  return(
    exp(
      dependent_vars + independent_vars + 0.1618
    )
  )



}
